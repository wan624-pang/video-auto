{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "title": "Video Auto Manifest",
  "type": "object",
  "required": ["project", "segments"],
  "properties": {
    "version": { "type": "string", "default": "1.0" },
    "project": {
      "type": "object",
      "required": ["resolution", "fps"],
      "properties": {
        "resolution": { "type": "string", "description": "å¦‚ 1920x1080" },
        "aspect_ratio": { "type": "string", "enum": ["16:9", "9:16", "1:1"], "default": "16:9" },
        "fps": { "type": "integer", "minimum": 1, "default": 30 },
        "min_image_duration_ms": { "type": "integer", "minimum": 100, "default": 5000 },
        "default_transition": {
          "type": "object",
          "properties": {
            "type": { "type": "string", "enum": ["none", "crossfade", "slide_left", "slide_right", "zoom"], "default": "crossfade" },
            "duration_ms": { "type": "integer", "minimum": 0, "default": 300 }
          },
          "additionalProperties": false
        },
        "default_ken_burns": {
          "type": "object",
          "properties": {
            "enabled": { "type": "boolean", "default": true },
            "direction": { "type": "string", "enum": ["auto", "left", "right", "up", "down"], "default": "auto" },
            "amplitude": { "type": "number", "minimum": 0, "maximum": 1, "default": 0.21 }
          },
          "additionalProperties": false
        },
        "text_style": {
          "type": "object",
          "properties": {
            "font_family": { "type": "string", "default": "Default" },
            "font_size": { "type": "integer", "minimum": 8, "default": 64 },
            "color": { "type": "string", "default": "#FFFFFF" },
            "stroke_color": { "type": "string", "default": "#000000" },
            "stroke_width": { "type": "number", "minimum": 0, "default": 3 },
            "shadow": { "type": "boolean", "default": true },
            "bold": { "type": "boolean", "default": false },
            "italic": { "type": "boolean", "default": false },
            "align": { "type": "string", "enum": ["left", "center", "right"], "default": "center" },
            "position": {
              "type": "object",
              "properties": {
                "x_pct": { "type": "number", "minimum": 0, "maximum": 100, "default": 50 },
                "y_pct": { "type": "number", "minimum": 0, "maximum": 100, "default": 85 }
              },
              "additionalProperties": false
            },
            "max_width_pct": { "type": "number", "minimum": 10, "maximum": 100, "default": 90 },
            "line_height": { "type": "number", "minimum": 0.8, "maximum": 3, "default": 1.2 }
          },
          "additionalProperties": false
        },
        "safe_margins": {
          "type": "object",
          "properties": {
            "left_pct": { "type": "number", "minimum": 0, "maximum": 50, "default": 5 },
            "right_pct": { "type": "number", "minimum": 0, "maximum": 50, "default": 5 },
            "top_pct": { "type": "number", "minimum": 0, "maximum": 50, "default": 5 },
            "bottom_pct": { "type": "number", "minimum": 0, "maximum": 50, "default": 10 }
          },
          "additionalProperties": false
        },
        "bgm": {
          "type": "object",
          "properties": {
            "path": { "type": "string" },
            "volume": { "type": "number", "minimum": 0, "maximum": 1, "default": 0.3 },
            "ducking": {
              "type": "object",
              "properties": {
                "enabled": { "type": "boolean", "default": true },
                "reduce_db": { "type": "number", "default": 12 },
                "attack_ms": { "type": "integer", "minimum": 0, "default": 200 },
                "release_ms": { "type": "integer", "minimum": 0, "default": 300 },
                "prepad_ms": { "type": "integer", "minimum": 0, "default": 150 },
                "postpad_ms": { "type": "integer", "minimum": 0, "default": 250 }
              },
              "additionalProperties": false
            }
          },
          "additionalProperties": false
        },
        "opening": {
          "type": "object",
          "properties": {
            "enabled": { "type": "boolean", "default": false },
            "text": { "type": "string" },
            "duration_ms": { "type": "integer", "minimum": 100, "default": 1500 }
          },
          "additionalProperties": false
        },
        "ending": {
          "type": "object",
          "properties": {
            "enabled": { "type": "boolean", "default": false },
            "text": { "type": "string" },
            "duration_ms": { "type": "integer", "minimum": 100, "default": 1500 }
          },
          "additionalProperties": false
        },
        "watermark": {
          "type": "object",
          "properties": {
            "enabled": { "type": "boolean", "default": false },
            "path": { "type": "string" },
            "opacity": { "type": "number", "minimum": 0, "maximum": 1, "default": 0.5 }
          },
          "additionalProperties": false
        }
      },
      "additionalProperties": false
    },
    "segments": {
      "type": "array",
      "items": {
        "type": "object",
        "required": ["audio", "images"],
        "properties": {
          "id": { "type": "string" },
          "audio": {
            "type": "object",
            "required": ["path"],
            "properties": {
              "path": { "type": "string" },
              "volume": { "type": "number", "minimum": 0, "maximum": 1, "default": 1.0 }
            },
            "additionalProperties": false
          },
          "images": {
            "type": "array",
            "minItems": 1,
            "items": {
              "type": "object",
              "required": ["path"],
              "properties": {
                "path": { "type": "string" },
                "weight": { "type": "number", "minimum": 0, "default": 1 },
                "ken_burns": {
                  "type": "object",
                  "properties": {
                    "direction": { "type": "string", "enum": ["auto", "left", "right", "up", "down"] },
                    "amplitude": { "type": "number", "minimum": 0, "maximum": 1 }
                  },
                  "additionalProperties": false
                }
              },
              "additionalProperties": false
            }
          },
          "text": { "type": "string" },
          "text_style": { "$ref": "#/properties/project/properties/text_style" },
          "transition": { "$ref": "#/properties/project/properties/default_transition" },
          "min_image_duration_ms": { "type": "integer", "minimum": 100 }
        },
        "additionalProperties": false
      }
    }
  },
  "additionalProperties": false
}
